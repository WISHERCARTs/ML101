"""
Linear Regression - ‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î (MaxTemp) ‡∏à‡∏≤‡∏Å‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î (MinTemp)

üìå ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå:
   - ‡πÉ‡∏ä‡πâ Linear Regression ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á MinTemp ‡πÅ‡∏•‡∏∞ MaxTemp
   - ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏π‡πâ MinTemp (‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î) ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏à‡∏∞‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢ MaxTemp (‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î) ‡πÑ‡∏î‡πâ

üìå ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£ Linear Regression:
   - ‡∏´‡∏≤‡∏™‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á: y = mx + b
   - m = slope (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏ô), b = intercept (‡∏à‡∏∏‡∏î‡∏ï‡∏±‡∏î‡πÅ‡∏Å‡∏ô y)
   - ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏à‡∏∞‡∏´‡∏≤‡∏Ñ‡πà‡∏≤ m ‡πÅ‡∏•‡∏∞ b ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ñ‡πà‡∏≤ error ‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î

üìå ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô:
   1. ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Load Data)
   2. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Prepare Data) - ‡πÅ‡∏¢‡∏Å feature (x) ‡πÅ‡∏•‡∏∞ target (y)
   3. ‡πÅ‡∏ö‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Split Data) - 80% train, 20% test
   4. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞ train ‡πÇ‡∏°‡πÄ‡∏î‡∏• (Train Model)
   5. ‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤ (Predict)
   6. ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏• (Evaluate) - ‡∏ß‡∏±‡∏î‡∏Ñ‡πà‡∏≤ error

üìå Metrics ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ß‡∏±‡∏î‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û:
   - MAE: ‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Ç‡∏≠‡∏á |‡∏Ñ‡πà‡∏≤‡∏à‡∏£‡∏¥‡∏á - ‡∏Ñ‡πà‡∏≤‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢| ‚Üí ‡∏¢‡∏¥‡πà‡∏á‡∏ï‡πà‡∏≥‡∏¢‡∏¥‡πà‡∏á‡∏î‡∏µ
   - MSE: ‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Ç‡∏≠‡∏á (‡∏Ñ‡πà‡∏≤‡∏à‡∏£‡∏¥‡∏á - ‡∏Ñ‡πà‡∏≤‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢)¬≤ ‚Üí ‡∏•‡∏á‡πÇ‡∏ó‡∏© error ‡πÉ‡∏´‡∏ç‡πà‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô
   - RMSE: ‚àöMSE ‚Üí ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á ‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡πà‡∏≤‡∏¢‡∏Å‡∏ß‡πà‡∏≤ MSE
   - R¬≤: 0-1 ‚Üí ‡∏¢‡∏¥‡πà‡∏á‡πÉ‡∏Å‡∏•‡πâ 1 ‡∏¢‡∏¥‡πà‡∏á‡∏î‡∏µ (‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡∏î‡∏µ)

"""

# ========================== 1. IMPORT LIBRARIES ==========================
# ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤ library ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô
import numpy as np              # ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ array ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ó‡∏≤‡∏á‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå
import pandas as pd             # ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á (DataFrame) - ‡∏≠‡πà‡∏≤‡∏ô/‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô CSV
import matplotlib.pyplot as plt # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏•‡∏∞ visualization
from sklearn.model_selection import train_test_split  # ‡πÅ‡∏ö‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• train/test
from sklearn.linear_model import LinearRegression     # ‡πÇ‡∏°‡πÄ‡∏î‡∏• Linear Regression
from sklearn import metrics     # ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ error (MAE, MSE, R¬≤)


# ========================== 2. LOAD DATA ==========================
# ‡πÇ‡∏´‡∏•‡∏î dataset ‡∏à‡∏≤‡∏Å GitHub (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®)
# Dataset ‡∏°‡∏µ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå: MinTemp (‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î) ‡πÅ‡∏•‡∏∞ MaxTemp (‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î)
dataset = pd.read_csv('https://raw.githubusercontent.com/kongruksiamza/MachineLearning/refs/heads/master/Linear%20Regression/Weather.csv')

# üí° TIP: ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢:
# print(dataset.head())      # ‡πÅ‡∏™‡∏î‡∏á 5 ‡πÅ‡∏ñ‡∏ß‡πÅ‡∏£‡∏Å
# print(dataset.shape)       # ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡∏ô‡∏≤‡∏î (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ñ‡∏ß, ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå)
# print(dataset.describe())  # ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô (mean, std, min, max)


# ========================== 3. PREPARE DATA ==========================
# ‡πÅ‡∏¢‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô feature (x) ‡πÅ‡∏•‡∏∞ target (y)
#
# üìù ‡∏ó‡∏≥‡πÑ‡∏°‡∏ï‡πâ‡∏≠‡∏á reshape(-1, 1)?
#    - sklearn ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ input ‡πÄ‡∏õ‡πá‡∏ô 2D array ‚Üí shape (n_samples, n_features)
#    - reshape(-1, 1) ‡πÅ‡∏õ‡∏•‡∏á‡∏à‡∏≤‡∏Å [1, 2, 3] ‡πÄ‡∏õ‡πá‡∏ô [[1], [2], [3]]
#    - -1 ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á "‡πÉ‡∏´‡πâ numpy ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ñ‡∏ß‡πÄ‡∏≠‡∏á"

x = dataset["MinTemp"].values.reshape(-1, 1)  # Feature: ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î (input)
y = dataset["MaxTemp"].values.reshape(-1, 1)  # Target: ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î (output ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢)


# ========================== 4. SPLIT DATA ==========================
# ‡πÅ‡∏ö‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô 2 ‡∏™‡πà‡∏ß‡∏ô:
#   - Training set (80%): ‡πÉ‡∏ä‡πâ‡∏™‡∏≠‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏•
#   - Testing set (20%): ‡πÉ‡∏ä‡πâ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏• (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡πÄ‡∏´‡πá‡∏ô)
#
# üìù Parameters:
#   - test_size=0.2 ‚Üí 20% ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö test, 80% ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö train
#   - random_state=0 ‚Üí ‡∏Å‡∏≥‡∏´‡∏ô‡∏î seed ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ô

x_train, x_test, y_train, y_test = train_test_split(
    x, y, 
    test_size=0.2,    # 20% ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö test
    random_state=0    # seed ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏° (‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå reproducible)
)


# ========================== 5. CREATE & TRAIN MODEL ==========================
# ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏• Linear Regression ‡πÅ‡∏•‡∏∞ train ‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• training
#
# üìù ‡∏Å‡∏≤‡∏£ train ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?
#    - ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏à‡∏∞‡∏´‡∏≤‡∏Ñ‡πà‡∏≤ coefficient (m) ‡πÅ‡∏•‡∏∞ intercept (b) ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
#    - ‡∏™‡∏°‡∏Å‡∏≤‡∏£: MaxTemp = m √ó MinTemp + b
#    - "‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î" = ‡∏ó‡∏≥‡πÉ‡∏´‡πâ sum of squared errors ‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î

model = LinearRegression()
model.fit(x_train, y_train)  # train ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏î‡πâ‡∏ß‡∏¢ training data

# üí° TIP: ‡∏î‡∏π coefficient ‡πÅ‡∏•‡∏∞ intercept ‡∏ó‡∏µ‡πà‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡πÑ‡∏î‡πâ:
# print(f"Coefficient (slope): {model.coef_[0][0]:.4f}")
# print(f"Intercept: {model.intercept_[0]:.4f}")
# print(f"‡∏™‡∏°‡∏Å‡∏≤‡∏£: MaxTemp = {model.coef_[0][0]:.4f} √ó MinTemp + {model.intercept_[0]:.4f}")


# ========================== 6. PREDICT ==========================
# ‡πÉ‡∏ä‡πâ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏µ‡πà train ‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤ MaxTemp ‡∏à‡∏≤‡∏Å x_test (MinTemp)
# y_pred = ‡∏Ñ‡πà‡∏≤ MaxTemp ‡∏ó‡∏µ‡πà‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢
# y_test = ‡∏Ñ‡πà‡∏≤ MaxTemp ‡∏à‡∏£‡∏¥‡∏á (‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö)

y_pred = model.predict(x_test)


# ========================== 7. COMPARE RESULTS ==========================
# ‡∏™‡∏£‡πâ‡∏≤‡∏á DataFrame ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡∏£‡∏¥‡∏á (Actual) ‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢ (Predicted)
#
# üìù flatten() ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?
#    - ‡πÅ‡∏õ‡∏•‡∏á [[1], [2], [3]] ‡πÄ‡∏õ‡πá‡∏ô [1, 2, 3]
#    - ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á DataFrame ‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô

df = pd.DataFrame({
    'Actual': y_test.flatten(),     # ‡∏Ñ‡πà‡∏≤ MaxTemp ‡∏à‡∏£‡∏¥‡∏á
    'Predicted': y_pred.flatten()   # ‡∏Ñ‡πà‡∏≤ MaxTemp ‡∏ó‡∏µ‡πà‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢
})

print("=" * 50)
print("üìä ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡∏£‡∏¥‡∏á vs ‡∏Ñ‡πà‡∏≤‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢ (5 ‡πÅ‡∏ñ‡∏ß‡πÅ‡∏£‡∏Å):")
print("=" * 50)
print(df.head())  # ‡πÅ‡∏™‡∏î‡∏á 5 ‡πÅ‡∏ñ‡∏ß‡πÅ‡∏£‡∏Å
print(f"\nüìå ‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• test set: {df.shape[0]} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£")


# ========================== 8. VISUALIZATION ==========================
# ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏ó‡πà‡∏á‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö Actual vs Predicted (20 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏£‡∏Å)
# ‡∏Å‡∏£‡∏≤‡∏ü‡∏ô‡∏µ‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏†‡∏≤‡∏û‡∏ß‡πà‡∏≤‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á‡∏Ñ‡πà‡∏≤‡∏à‡∏£‡∏¥‡∏á‡πÅ‡∏Ñ‡πà‡πÑ‡∏´‡∏ô

df1 = df.head(20)  # ‡πÉ‡∏ä‡πâ 20 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏£‡∏Å (‡πÑ‡∏°‡πà‡∏á‡∏±‡πâ‡∏ô‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏ô‡πà‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ)
df1.plot(kind='bar', figsize=(16, 10))
plt.grid(which='major', linestyle='-', linewidth='0.5', color='green')
plt.grid(which='minor', linestyle=':', linewidth='0.5', color='black')
plt.title('üìä Actual vs Predicted MaxTemp', fontsize=14)
plt.xlabel('Sample Index')
plt.ylabel('Temperature (¬∞C)')
plt.legend(['Actual MaxTemp', 'Predicted MaxTemp'])
plt.tight_layout()
plt.show()


# ========================== 9. EVALUATE MODEL ==========================
# ‡∏ß‡∏±‡∏î‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏î‡πâ‡∏ß‡∏¢ metrics ‡∏ï‡πà‡∏≤‡∏á‡πÜ

print("\n" + "=" * 50)
print("üìà MODEL EVALUATION (‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡πÇ‡∏°‡πÄ‡∏î‡∏•)")
print("=" * 50)

# --- MAE (Mean Absolute Error) ---
# ‡∏™‡∏π‡∏ï‡∏£: MAE = (1/n) √ó Œ£|y_actual - y_predicted|
# ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢: ‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Ç‡∏≠‡∏á absolute error
# ‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°: ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏ú‡∏¥‡∏î‡πÑ‡∏õ‡∏Å‡∏µ‡πà‡∏≠‡∏á‡∏®‡∏≤
mae = metrics.mean_absolute_error(y_test, y_pred)
print(f"‚úÖ MAE (Mean Absolute Error): {mae:.4f}")
print(f"   ‚Üí ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏ú‡∏¥‡∏î‡πÑ‡∏õ {mae:.2f}¬∞C")

# --- MSE (Mean Squared Error) ---
# ‡∏™‡∏π‡∏ï‡∏£: MSE = (1/n) √ó Œ£(y_actual - y_predicted)¬≤
# ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢: ‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Ç‡∏≠‡∏á squared error
# ‡∏Ç‡πâ‡∏≠‡∏î‡∏µ: ‡∏•‡∏á‡πÇ‡∏ó‡∏© error ‡πÉ‡∏´‡∏ç‡πà‡πÜ ‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô (‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏¢‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏≠‡∏á)
mse = metrics.mean_squared_error(y_test, y_pred)
print(f"‚úÖ MSE (Mean Squared Error): {mse:.4f}")

# --- RMSE (Root Mean Squared Error) ---
# ‡∏™‡∏π‡∏ï‡∏£: RMSE = ‚àöMSE
# ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢: ‡∏£‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á‡∏Ç‡∏≠‡∏á MSE
# ‡∏Ç‡πâ‡∏≠‡∏î‡∏µ: ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á ‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡πà‡∏≤‡∏¢‡∏Å‡∏ß‡πà‡∏≤ MSE
rmse = np.sqrt(mse)
print(f"‚úÖ RMSE (Root Mean Squared Error): {rmse:.4f}")
print(f"   ‚Üí ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏ú‡∏¥‡∏î‡πÑ‡∏õ ¬±{rmse:.2f}¬∞C")

# --- R¬≤ Score (Coefficient of Determination) ---
# ‡∏Ñ‡πà‡∏≤ 0-1: ‡∏¢‡∏¥‡πà‡∏á‡πÉ‡∏Å‡∏•‡πâ 1 ‡∏¢‡∏¥‡πà‡∏á‡∏î‡∏µ
# ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢: ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏õ‡∏£‡∏õ‡∏£‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡∏Å‡∏µ‡πà %
# ‡πÄ‡∏ä‡πà‡∏ô R¬≤ = 0.85 ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÑ‡∏î‡πâ 85% ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏õ‡∏£‡∏õ‡∏£‡∏ß‡∏ô
r2 = metrics.r2_score(y_test, y_pred)
print(f"‚úÖ R¬≤ Score: {r2:.4f}")
print(f"   ‚Üí ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏õ‡∏£‡∏õ‡∏£‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ {r2*100:.2f}%")

print("=" * 50)


# ========================== OPTIONAL: ADDITIONAL VISUALIZATIONS ==========================
# (comment ‡πÑ‡∏ß‡πâ - uncomment ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô)

# --- Scatter Plot ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏™‡πâ‡∏ô Regression ---
# ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢
# plt.figure(figsize=(10, 6))
# plt.scatter(x_test, y_test, color='blue', alpha=0.6, label='Actual Data')
# plt.plot(x_test, y_pred, color='red', linewidth=2, label='Regression Line')
# plt.xlabel('MinTemp (¬∞C)')
# plt.ylabel('MaxTemp (¬∞C)')
# plt.title('Linear Regression: MinTemp vs MaxTemp')
# plt.legend()
# plt.grid(True, alpha=0.3)
# plt.show()

# --- Scatter Plot ‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ---
# ‡∏î‡∏π‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
# dataset.plot(x='MinTemp', y='MaxTemp', style='o', figsize=(10, 6))
# plt.title('MinTemp vs MaxTemp (All Data)')
# plt.xlabel('MinTemp (¬∞C)')
# plt.ylabel('MaxTemp (¬∞C)')
# plt.grid(True, alpha=0.3)
# plt.show()

# --- Residual Plot ---
# ‡∏î‡∏π‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á error (‡∏Ñ‡πà‡∏≤‡∏à‡∏£‡∏¥‡∏á - ‡∏Ñ‡πà‡∏≤‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢)
# residuals = y_test.flatten() - y_pred.flatten()
# plt.figure(figsize=(10, 6))
# plt.scatter(y_pred.flatten(), residuals, alpha=0.6)
# plt.axhline(y=0, color='red', linestyle='--')
# plt.xlabel('Predicted MaxTemp (¬∞C)')
# plt.ylabel('Residuals (Actual - Predicted)')
# plt.title('Residual Plot')
# plt.grid(True, alpha=0.3)
# plt.show()